<view class="container">
  <view wx:if="{{loading}}" class="loading">
    <text>加载中...</text>
  </view>
  
  <view wx:elif="{{groupInfo}}" class="group-detail">
    <!-- 1. 圈子详情 -->
    <view class="group-info-section">
      <view class="group-header">
        <view class="group-name">{{groupInfo.name}}</view>
        <view wx:if="{{groupInfo.description}}" class="group-desc">{{groupInfo.description}}</view>
      </view>
      
      <view class="group-stats">
        <view class="stat-item clickable" bindtap="onViewMembers">
          <text class="stat-label">成员</text>
          <text class="stat-value">{{groupInfo.memberCount}}人</text>
          <text class="stat-arrow">></text>
        </view>
        <view class="stat-item">
          <text class="stat-label">类型</text>
          <text class="stat-value">{{groupInfo.groupType}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">状态</text>
          <text class="stat-value status-{{groupInfo.status}}">{{groupInfo.status === 'approved' ? '已通过' : groupInfo.status === 'pending' ? '待审核' : '已拒绝'}}</text>
        </view>
      </view>
      
      <view class="creator-info">
        <view class="creator-header">
          <text class="creator-title">创建者</text>
        </view>
        <view class="creator-card">
          <user-avatar
            avatar="{{groupInfo.createdByInfo.avatar}}"
            name="{{groupInfo.createdByInfo.name}}"
            username="{{groupInfo.createdByInfo.username}}"
            size="medium"
            show-name="{{true}}"
          />
        </view>
      </view>
    </view>


    <!-- 3. 圈子的活动相关信息 -->
    <view class="events-section">
      <view class="section-header">
        <text class="section-title">活动</text>
        <view class="section-more">
          <text class="event-count">{{events.length}}个</text>
          <text class="view-more">查看全部 ></text>
        </view>
      </view>
      <view wx:if="{{events.length > 0}}" class="events-preview">
        <view wx:for="{{events}}" wx:for-item="event" wx:for-index="index" wx:key="id" wx:if="{{index < 3}}" class="event-item">
          <view class="event-title">{{event.title}}</view>
          <view class="event-meta">
            <text class="event-time">{{event.startTime}}</text>
            <text class="event-location">{{event.location}}</text>
          </view>
        </view>
      </view>
      <view wx:else class="empty-content">
        <text>暂无活动</text>
      </view>
    </view>

    <!-- 4. 圈子的动态 -->
    <view class="dynamics-section">
      <view class="section-header">
        <text class="section-title">动态</text>
        <view class="section-more">
          <text class="dynamic-count">{{dynamics.length}}条</text>
          <text class="view-more">查看全部 ></text>
        </view>
      </view>
      <view wx:if="{{dynamics.length > 0}}" class="dynamics-preview">
        <view wx:for="{{dynamics}}" wx:for-item="dynamic" wx:for-index="index" wx:key="id" wx:if="{{index < 3}}" class="dynamic-item">
          <view class="dynamic-content">{{dynamic.content}}</view>
          <view class="dynamic-meta">
            <text class="dynamic-author">{{dynamic.authorName}}</text>
            <text class="dynamic-time">{{dynamic.createdAt}}</text>
          </view>
        </view>
      </view>
      <view wx:else class="empty-content">
        <text>暂无动态</text>
      </view>
    </view>
  </view>
  
  <view wx:else class="empty">
    <text>圈子不存在</text>
  </view>

  <!-- 5. 加入圈子固定在底部 -->
  <view wx:if="{{groupInfo && !groupInfo.isJoined}}" class="fixed-bottom">
    <button class="join-btn" bindtap="onJoinGroup">加入圈子</button>
  </view>
</view>
